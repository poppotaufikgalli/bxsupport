import { defineNuxtRouteMiddleware, useRuntimeConfig } from "#app";
import useSession from "../composables/useSession.mjs";
export default defineNuxtRouteMiddleware((to) => {
  if (to.meta.auth === false) {
    return;
  }
  const { status, signIn } = useSession();
  if (status.value === "authenticated") {
    return;
  }
  const authConfig = useRuntimeConfig().public.auth;
  if (authConfig.globalMiddlewareOptions.allow404WithoutAuth) {
    const matchedRoute = to.matched.length > 0;
    if (!matchedRoute) {
      return;
    }
  }
  return signIn(void 0, { callbackUrl: to.path, error: "SessionRequired" });
});
